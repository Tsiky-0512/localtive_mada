"use strict";(self.webpackChunkownily=self.webpackChunkownily||[]).push([[97],{9097:(Q,f,a)=>{a.r(f),a.d(f,{InvoiceModule:()=>U});var d=a(6814),u=a(800),m=a(5861),c=a(6223);const C=JSON.parse('[{"label":"Date quittance","controlName":"dateQuittance","type":"date","constraintList":["required"]},{"label":"Date paiement","controlName":"datePaiement","type":"date","constraintList":["required"]},{"label":"Ann\xe9e","controlName":"year","type":"number","constraintList":["min","max","required"]},{"label":"Mois","controlName":"mois","type":"number","constraintList":["min","max","required"]}]');var e=a(5879),h=a(4036),g=a(6023),M=a(6452),Z=a(9862);let p=(()=>{class n extends M.I{constructor(t){super("api/factures",t),this.http=t}generate(t){var o=this;return(0,m.Z)(function*(){return yield(0,h.z)(o.http.post((0,g.F)("api/factures/generate"),t))})()}send(t){var o=this;return(0,m.Z)(function*(){return yield Promise.all(t.map(s=>(0,h.z)(o.http.get((0,g.F)(`api/factures/send/${s._id}`)))))})()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(Z.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var l=a(1311),v=a(2296),b=a(9753);function F(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",5)(2,"div",8),e._UZ(3,"app-input",9),e.qZA()(),e.BQk()),2&n){const t=r.$implicit,o=e.oxw();e.xp6(3),e.Q6J("label",t.label)("form",o.form)("type",t.type)("controlName",t.controlName)("constraintList",t.constraintList)}}let L=(()=>{class n{constructor(t,o,s,i){this.fb=t,this.route=o,this.service=s,this.router=i,this.inputs=C,this.months=["Janvier","F\xe9vrier","Mars","Avril","Mai","Juin","Juillet","Ao\xfbt","Septembre","Octobre","Novembre","D\xe9cembre"],this.form=this.fb.group({dateQuittance:["",c.kI.required],datePaiement:["",[c.kI.min(0),c.kI.required]],mois:[1,[c.kI.required,c.kI.min(1),c.kI.max(12)]],year:[2023,[c.kI.required,c.kI.min(0)]]})}validate(){var t=this;if(this.form.valid){const o=this.form.value,s={...o,mois:this.months[o.mois-1]+" "+o.year};this.service.generate(s).then(function(){var i=(0,m.Z)(function*(Y){yield t.router.navigate(["/factures","liste"])});return function(Y){return i.apply(this,arguments)}}())}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(c.qu),e.Y36(u.gz),e.Y36(p),e.Y36(u.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-invoice-generator"]],decls:12,vars:2,consts:[[1,"mb-4"],[1,"mb-0"],[1,"container"],[1,"form",3,"formGroup"],[4,"ngFor","ngForOf"],[1,"c-row"],[1,"c-col-12"],["mat-raised-button","","color","primary",3,"click"],[1,"c-col-12","mb-2"],[3,"label","form","type","controlName","constraintList"]],template:function(t,o){1&t&&(e.TgZ(0,"c-card",0)(1,"c-card-header")(2,"h1",1),e._uU(3,"G\xe9n\xe9rateur de facture"),e.qZA()(),e.TgZ(4,"c-card-body")(5,"div",2)(6,"form",3),e.YNc(7,F,4,5,"ng-container",4),e.TgZ(8,"div",5)(9,"div",6)(10,"button",7),e.NdJ("click",function(){return o.validate()}),e._uU(11,"G\xe9n\xe9rer"),e.qZA()()()()()()()),2&t&&(e.xp6(6),e.Q6J("formGroup",o.form),e.xp6(1),e.Q6J("ngForOf",o.inputs))},dependencies:[d.sg,l.yue,l.AkF,l.nkx,c._Y,c.JL,v.lW,b.a,c.sg]}),n})();var T=a(2802),y=a(6731);let I=(()=>{class n extends T.J{constructor(t,o,s){super(),this.service=t,this.router=o,this.datePipe=s,this.titles=["Quittance","Paiement","Mois","Locataire","Adresse postale","Loyer"],this.getters=[i=>this.datePipe.transform(i.dateQuittance),i=>this.datePipe.transform(i.datePaiement),i=>i.mois,i=>i.locataireDetails.nom+" "+i.locataireDetails.prenom,i=>i.bienDetails?.adressePostale,i=>i.loyer],this.actions=[],this.updateCommand=[]}ngOnInit(){this.find()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p),e.Y36(u.F0),e.Y36(d.uU))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-invoice-list"]],features:[e.qOj],decls:7,vars:6,consts:[[1,"mb-0"],[3,"titles","getters","data","actions","count","pageSize","page"]],template:function(t,o){1&t&&(e.TgZ(0,"c-card")(1,"c-card-header")(2,"h1",0),e._uU(3,"Liste des factures"),e.qZA()(),e.TgZ(4,"c-card-body")(5,"app-paginated-table",1),e.NdJ("page",function(i){return o.find(i)}),e.qZA()()(),e._UZ(6,"br")),2&t&&(e.xp6(5),e.Q6J("titles",o.titles)("getters",o.getters)("data",o.data)("actions",o.actions)("count",o.count)("pageSize",10))},dependencies:[l.yue,l.AkF,l.nkx,y.v]}),n})();var k=a(1502);const S=[{path:"",redirectTo:"/",pathMatch:"full"},{path:"generateur",component:L,pathMatch:"full",data:{title:"G\xe9narateur de facture"}},{path:"liste",component:I,pathMatch:"full",data:{title:"Liste des factures"}},{path:"mailer",component:(()=>{class n extends I{constructor(t,o,s){super(t,o,s),this._service=t,this._router=o,this._datePipe=s,this.checked=[]}registerCheckedList(t){this.checked=t}send(){0!==this.checked.length?this.service.send(this.checked).then(t=>{(0,k.s)()}):alert("Veuillez s\xe9lectionnez au moins une facture")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p),e.Y36(u.F0),e.Y36(d.uU))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-invoice-mail-sender"]],features:[e.qOj],decls:10,vars:7,consts:[[1,"mb-0"],[3,"titles","getters","data","actions","count","pageSize","showCheckBox","page","emitChecked"],["mat-raised-button","","color","primary",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"c-card")(1,"c-card-header")(2,"h1",0),e._uU(3,"Envoie de factures par email."),e.qZA()(),e.TgZ(4,"c-card-body")(5,"app-paginated-table",1),e.NdJ("page",function(i){return o.find(i)})("emitChecked",function(i){return o.registerCheckedList(i)}),e.qZA()(),e.TgZ(6,"c-card-footer")(7,"button",2),e.NdJ("click",function(){return o.send()}),e._uU(8,"Envoyer"),e.qZA()()(),e._UZ(9,"br")),2&t&&(e.xp6(5),e.Q6J("titles",o.titles)("getters",o.getters)("data",o.data)("actions",o.actions)("count",o.count)("pageSize",10)("showCheckBox",!0))},dependencies:[l.yue,l.AkF,l.nkx,v.lW,y.v,l.xUh]}),n})(),pathMatch:"full",data:{title:"Envoie de mail"}}];let A=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[u.Bz.forChild(S),u.Bz]}),n})();var J=a(9157),N=a(3680),z=a(8525),G=a(1165);let U=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[d.ez,A,l.yue,l.AkF,l.nkx,c.u5,v.ot,J.lN,N.Ng,z.LD,G.X,c.UX,l.xUh]}),n})()}}]);